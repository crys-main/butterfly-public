<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Sink: 轻量化链接缩短器</title>
      <link href="/posts/f82c473/"/>
      <url>/posts/f82c473/</url>
      
        <content type="html"><![CDATA[<h2 id="Sink：一款可部署在Cloudflare上的轻量级链接缩短器"><a href="#Sink：一款可部署在Cloudflare上的轻量级链接缩短器" class="headerlink" title="Sink：一款可部署在Cloudflare上的轻量级链接缩短器"></a>Sink：一款可部署在Cloudflare上的轻量级链接缩短器</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Sink 是一个简洁、快速且功能强大的链接缩短器。它的特别之处在于，可以免费部署在 Cloudflare 的 Workers 和 Pages 上，自带美观的管理面板和基础的分析功能，让你完全掌控自己的数据。</p><blockquote><p><strong>注：</strong> 虽然本文主要使用 Cloudflare 进行部署教程，但 Sink 也支持通过其他方式部署，感兴趣可以前往其官方页面查看。</p></blockquote><ul><li><strong>项目官方页面</strong>: <a href="https://github.com/miantiao-me/Sink">https://github.com/miantiao-me/Sink</a></li></ul><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>在开始之前，你需要准备以下东西：</p><ol><li><strong>一个 Cloudflare 账号</strong>（如果使用 Cloudflare 部署，此为必须）</li><li><strong>一个 GitHub 账号</strong>（用于 Fork 项目代码）</li><li><strong>一个域名</strong>（可选，但强烈推荐，用于绑定你的短链接服务）</li></ol><blockquote><p><strong>提示：</strong> 本教程使用了手机浏览器页面进行截图提示，但所有操作步骤和界面逻辑与电脑端完全一致，请放心跟随操作</p></blockquote><hr><h3 id="详细部署步骤"><a href="#详细部署步骤" class="headerlink" title="详细部署步骤"></a>详细部署步骤</h3><h4 id="第一步：Fork-项目"><a href="#第一步：Fork-项目" class="headerlink" title="第一步：Fork 项目"></a>第一步：Fork 项目</h4><ol><li>首先，打开上面提供的 Sink 项目 GitHub 链接。</li><li>如果你觉得项目不错，可以给作者点个 ⭐Star 以示支持。</li><li>点击右上角的 <strong>Fork</strong> 按钮，将项目代码复制到自己的 GitHub 仓库中。<br><img src="https://img.cdn1.vip/i/699549f10f8dd_1771391473.webp" alt="配图"></li></ol><h4 id="第二步：在-Cloudflare-Pages-上创建项目"><a href="#第二步：在-Cloudflare-Pages-上创建项目" class="headerlink" title="第二步：在 Cloudflare Pages 上创建项目"></a>第二步：在 Cloudflare Pages 上创建项目</h4><ol><li>登录你的 Cloudflare 账号，在左侧菜单栏找到并进入 <strong>Workers 和 Pages</strong>。</li><li>点击 <strong>创建应用程序</strong> 按钮。如果你是第一次使用，需要先 <strong>连接到 GitHub</strong>，授权 Cloudflare 访问你的仓库。</li><li>成功连接 GitHub 后，再次点击右上角的 <strong>创建应用程序</strong> 按钮。这一次，在页面最底部找到一行小字：<strong>“想要部署 Pages？开始使用”</strong>，点击它<br><img src="https://img.cdn1.vip/i/699549f530269_1771391477.webp" alt="配图"></li><li>选择 <strong>从 Git 仓库导入</strong>，在列表中找到并选择你刚刚 Fork 的 <code>Sink</code> 仓库，然后点击 <strong>开始设置</strong>。</li></ol><h4 id="第三步：配置构建与环境变量"><a href="#第三步：配置构建与环境变量" class="headerlink" title="第三步：配置构建与环境变量"></a>第三步：配置构建与环境变量</h4><ol><li>在“设置构建和部署”部分，<strong>框架预设</strong> 请选择 <strong>Nuxt.js</strong>。其他选项保持默认即可。</li><li>在页面下方，找到 <strong>环境变量</strong> 部分。这里我们需要添加一系列配置。</li></ol><h5 id="核心环境变量（必须填写）"><a href="#核心环境变量（必须填写）" class="headerlink" title="核心环境变量（必须填写）"></a>核心环境变量（必须填写）</h5><p>以下三个变量是必须配置的，请仔细按照说明获取：</p><ul><li><strong><code>NUXT_SITE_TOKEN</code></strong>：登录管理面板的密码，请务必设置一个复杂的、只有你知道的字符串。</li><li><strong><code>NUXT_CF_ACCOUNT_ID</code></strong>：你的 Cloudflare 账户 ID。<ul><li><em>获取方法</em>：随便选择一个你的域名进入仪表盘，右侧边栏下方可以看到“帐户 ID”；或者在 Workers 和 Pages 页面拉到最下方也能看到。</li></ul></li><li><strong><code>NUXT_CF_API_TOKEN</code></strong>：Cloudflare API 令牌，用于让 Sink 访问你的分析数据<ul><li><em>获取方法</em>：点击右上角头像 -&gt; [配置文件] -&gt; [API 令牌] -&gt; [创建令牌]。找到“读取分析数据和日志”模板，点击“使用模板”</li><li><strong>重点：</strong> 删除其他所有权限，只保留 <strong>“帐户分析”</strong> 的读取权限。最后在页面底部点击 <strong>“继续以显示摘要”</strong> -&gt; <strong>“创建令牌”</strong></li><li><strong>请务必保存好这个 Token，因为它只会显示一次！</strong></li></ul></li></ul><h5 id="其他环境变量（可选配置）"><a href="#其他环境变量（可选配置）" class="headerlink" title="其他环境变量（可选配置）"></a>其他环境变量（可选配置）</h5><p>以下变量如无特殊需要，无需配置。你也可以根据需要自行调整。</p><table><thead><tr><th align="left">变量名</th><th align="left">默认值&#x2F;示例</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left"><code>NUXT_PUBLIC_PREVIEW_MODE</code></td><td align="left"><code>true</code></td><td align="left">是否开启预览模式</td></tr><tr><td align="left"><code>NUXT_PUBLIC_SLUG_DEFAULT_LENGTH</code></td><td align="left"><code>5</code></td><td align="left">生成的短链接路径长度</td></tr><tr><td align="left"><code>NUXT_REDIRECT_STATUS_CODE</code></td><td align="left"><code>308</code></td><td align="left">重定向状态码</td></tr><tr><td align="left"><code>NUXT_LINK_CACHE_TTL</code></td><td align="left"><code>60</code></td><td align="left">链接缓存时间（秒）</td></tr><tr><td align="left"><code>NUXT_REDIRECT_WITH_QUERY</code></td><td align="left"><code>false</code></td><td align="left">重定向时是否携带原始查询参数</td></tr><tr><td align="left"><code>NUXT_HOME_URL</code></td><td align="left"><code>https://sink.cool</code></td><td align="left">你的首页地址（绑定域名后记得修改）</td></tr><tr><td align="left"><code>NUXT_DATASET</code></td><td align="left"><code>sink</code></td><td align="left">数据集名称</td></tr><tr><td align="left"><code>NUXT_AI_MODEL</code></td><td align="left"><code>@cf/meta/llama-3-8b-instruct</code></td><td align="left">（可选）用于 AI 功能的模型</td></tr><tr><td align="left"><code>NUXT_AI_PROMPT</code></td><td align="left"><code>&quot;You are a URL shortening assistant......&quot;</code></td><td align="left">（可选）AI 的提示词</td></tr></tbody></table><ol start="3"><li>将上述变量填写完成后，点击 <strong>保存并部署</strong> 按钮。Cloudflare 将开始自动构建和部署你的应用，第一次部署很快就会完成。</li></ol><h4 id="第四步：创建并绑定-KV-存储与-Analytics-Engine"><a href="#第四步：创建并绑定-KV-存储与-Analytics-Engine" class="headerlink" title="第四步：创建并绑定 KV 存储与 Analytics Engine"></a>第四步：创建并绑定 KV 存储与 Analytics Engine</h4><p>部署完成后，点击 <strong>继续处理项目</strong>，进入项目控制台。</p><ol><li><p><strong>创建 KV 命名空间</strong>：</p><ul><li>在左侧菜单找到 <strong>存储和数据库</strong> -&gt; <strong>KV</strong></li><li>点击 <strong>创建命名空间</strong>，名称可以随意，例如 <code>SINK_KV</code>，然后点击 <strong>添加</strong></li></ul></li><li><p><strong>启用 Analytics Engine</strong>：</p><ul><li>还是在 <strong>存储和数据库</strong> 下，找到 <strong>Analytics Engine</strong>，并点击 <strong>启用</strong> 这一步通常只需点击一次即可激活。</li></ul></li><li><p><strong>绑定资源到项目</strong>：</p><ul><li>返回你的 Sink 项目页面，点击上方的 <strong>设置</strong> 选项卡</li><li>在左侧菜单中选择 <strong>绑定</strong></li><li><strong>绑定 KV 命名空间</strong>：点击 <strong>添加绑定</strong>，选择 <strong>KV 命名空间</strong>。<strong>变量名称</strong> 必须设置为大写的 <strong><code>KV</code></strong>，在下拉框中选择你刚刚创建的 KV 命名空间（如 <code>SINK_KV</code>），然后点击 <strong>保存</strong></li><li><strong>绑定 Analytics Engine</strong>：再次点击 <strong>添加绑定</strong>，选择 <strong>Analytics Engine</strong>。<strong>变量名称</strong> 设置为 <strong><code>ANALYTICS</code></strong>，数据集填写 <strong><code>sink</code></strong>，然后点击 <strong>保存</strong></li></ul></li><li><p><strong>添加兼容性标志</strong>：</p><ul><li>仍在 <strong>设置</strong> 页面，找到左侧菜单的 <strong>运行时</strong>。</li><li>在 <strong>兼容性标志</strong> 区域，找到 <strong>生产兼容性标志</strong>，点击 <strong>添加标志</strong>，输入 <strong><code>nodejs_compat</code></strong>，然后点击 <strong>保存</strong>。</li></ul></li></ol><h4 id="第五步：最终部署与自定义域名"><a href="#第五步：最终部署与自定义域名" class="headerlink" title="第五步：最终部署与自定义域名"></a>第五步：最终部署与自定义域名</h4><ol><li>所有配置都完成后，我们需要让这些设置生效。回到项目的 <strong>部署</strong> 选项卡。</li><li>你会看到最近一次的部署记录。点击右侧的三个点（…）菜单，选择 <strong>重试部署</strong>。</li><li>等待这次部署完成。</li><li>部署成功后，你就可以为你的短链接服务绑定一个自定义域名了（强烈推荐！） 点击 <strong>自定义域</strong> 区域，按照提示添加你的域名即可</li></ol><h3 id="完成！"><a href="#完成！" class="headerlink" title="完成！"></a>完成！</h3><p>至此，所有设置均已大功告成！现在，你可以通过 Cloudflare 为你生成的 <code>.pages.dev</code> 临时域名，或者你绑定的自定义域名来访问你的 Sink 服务了。</p><p>在登录页面输入你之前设置的 <code>NUXT_SITE_TOKEN</code>，即可进入管理面板，开始创建你的第一个短链接，并查看点击数据啦！</p>]]></content>
      
      
      <categories>
          
          <category> 技术分享 </category>
          
          <category> Cloudflare </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> 开源项目 </tag>
            
            <tag> 链接 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于思考</title>
      <link href="/posts/e6432aea/"/>
      <url>/posts/e6432aea/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="这是一个无效的密码 请检查并重试" data-whm="这些解密内容无法验证 但你仍然可以查看">  <script id="hbeData" type="hbeData" data-hmacdigest="b7a8f1fed213db0c76ee593b8db16d9a56dbeb9e9f848da387a177e3366adffb">3953060be6b30f1d1e44393d084c20e0c3d365ef7d7def7e3abf8a21b638cf7a57301134ff1d859e3b7a05aeb8a3730993a0c7d81ea2ba873df5ec51c8cc8515f1c08a7e2aadac6d3329c79593423b0146b99e66eb1154b3052bdad067c79261192ac835462c5185ec719d139895d13a586ecef5ef10bc52f106a739d10674bc199645cf2ac10c67db80ae4eade388441804c6ccbcc3a9f384ae671970b1804a86b8612541cf766eb28fe278591770629ea78090fdb12e5f73abcc6a5d2d53b2dc007ec1962fcb0b3b8d139c2fb6c31d86e2f95928fa3aeebc9318a56268a084c410db6e344c54fe44f72bf50420c3501cfede7512c026ddcb8294f2113d34b3d8afedf38fae244c42644df0ce4e9b169bbfaf52884e41b86f875e94de50bd4fb0ecc962249ba6aa6fb77314848990e841e68e9f05deef2e7f25bf1deccc771ad23aabc987c9598417a54128f20e83182bedf2033b4ba50d1a9025d32a37429fbcfb2fbdb245d4536cd48310d4b48ec79acb1fc81fe07637dc3f06c443c84e204f898f867d2ac53972b67f52ab543e5387400f14b155889c2075719e94a4fdfb58b21ab5554e7faa6785679d7e889d4affa48335f9f431a6d1060343934f90e69558775e6e79abe90b70f712537612b9f375b8d98176f9602bccd35a6f684d2582016af6121681684a636f76e7b954a2ff1b149808bc2bca538bc7acb6038753a009669b2f5caba3872a822db089931622e733bcf6af21d5afe9a77aaf7c680ff2bd78f5ec1651a632c231d31c4701f38641e65b4d25c664daa73daffaaf4cab8389d25ea72340ffac56e0d4257daba83f3984316e7eba5154e504b65fff5a8e3c496f76e294b9540293e54ab446d9993e7f92d24b1713e9d18d8cb812342eee453cda2fc9b74f87fd35e9771be7239130116f38548e826b4a3413dcc63610fbe0257795470cf4775778efab2c53227a7c5df4af729342ff54cea59569dbcc2ad683d8ddb86e7750c7f82db0c7129015c71acf27274d4e066287f3c60c0220a3d7655d7285b860fae7ae78f059946d74e876a6fdf7b02083d0f504d1a4bc89bfee565f9b1d3312774bdcb89aeec3dcbbbd63cb52101a102a444aa5c1c3f04696f946e7e5e5e24419f4ef3fe7c290500a9698d0477c4a2e899a457700db7bfbc55d52e234585d1b7e693a472da76aeb597381508fa0556b6f9905df331d0de73ab47eb21d8a8dfe4c57f3ead1c4ca6c69479e037ab482c6e4cb0fa2ce5eb2ae5c88c6529e6ffcbddef31a79b548030b2c845b46935ed35fbfaeab92ca6dd7db2efd6e3bd00d6fd9e38714eb99e81eaea340d8e090690764aba6f4b145597577f37bee7bf2ff0b4f135ba01ae791d2bca7fa2d8282f6a02b1605905a5e34b3f207c6e29e09b28605aa0386bbe5d00b75fb893dc03881aee06a48e317d40eb5cfc58d8c44595fb38b156ee5c274be428121ba2526092b7648abb6892cb9aab76b4b14226306761d3b6b2cb9b1d139ff1fed85ee7903e2d1bd7bb279125d18e51257194e052acaa47c20a13e1589b95b7dd45bd93dfdd770b9ab8510cfbcd9e093a60583a2dfc9f3cc46ab24d5b3378b44bd672e9c3807e6e439f35d0a41f82240d4cd9bb0778854157e2537a78043c82b03c79aef1d89c88156e9e78d37ea0bee06d7df1d5e9cde824afce73f7d5d992877ba781dd1d1cf787203785ec62fdcbd6ebf395659819aecee14316fe7fc34900a11c3b37642020ff4033baf367e3466f3a25fa7cceb73a999e618d3c5b6bfc8ebef8471dd88cbe22defb9bc6c7c1d81de80c40436c094a69aebbf52de80b86720e64e10dca241134ed0ced8a72a3d99c7882293f2a4e6358c6ef722b2bea9b7032d50f62be0faa5009dbb9c97a64d3a197a2fb32e255dafd984c24cea3792722d236dbf8cb0443b4ea2f019a43a108b839e9dd8e32062d201fe06d06eb08ace00df82e82d6f800514bc5cfd29fbc757a9de9674923b5e605a9185574905e0c0aa6a770e8f5493691b5dab5db7ddd97b62012fb2ccd7008c53be732893d134b015694e0b0e08d44034030e4550c0ab89ca8338f42597f6d3dcc183f0a001a11bc6fe5d7c628e77e87d456f4cf5d0a271f9bd625ed4a844e8ce67bb9a5b10b39e10bca3121de69a10a07bcc2c4dd861646cb1c11c99873a05f915b36a4aec86a06264911cbc5ec8d9e48b9c6c1a55c64c3360c37868ec3c9b0b3664a0423a0030ed8ff268eaf3e7c472468beb31cd0f8aa1d6ddd08eba61afd04d1c8aae8a4de8c17f69a2a1801ba365dd350fe40299b398dad18bfd4f314fa8d2b11613fb962763d910538a9eaec1a61e1346d691739eac6c1b8eb70e31bc31e8729d95757be5c191a37f621015783956ed2449fb11516267409b10a3a77396c09656c248780d75520802e20babfdedf778a0a6e6dbfdd20601e6159c04075d2e138182abfa0b03717185f8d71577cff364cb78d6e8ae273fea3adc9bf860337c2383dc80a47d3146c7e488b2a5e1c72fb170834d87f27f52bb1cc97673ea22d4f185596ca65d45530901d9bbf13296f879adaa57052568c0e3fec224c49ec28766d8a1a560d3db5f5a17281d7d8efd8bdac8f93a82fb8bd38e0bbadc29818df9f25d94a8590e1e54f8bd7a730457f425f5c6615d346e8c05fcb26dcd3d60db69bc9359c8e2256e90805036bca21c8d887e9ffaef0ce61e80505be3722d1c99eb7c7e674bdf7cb2e9b3726829207199d95b89774e7822c82666d4479734cbec4d44b1503d7f1a03a63e2b9cc961a6b4d3c451f88e0eaecc5facd9cbec8e45f7924aaf939b730f6a8b96912ccecec3299d60f66de3ab6b13ce7f69dc472caadd1f90acd50cb8a705e6b1d80fc9f7e80aaee488bc991c35654a27612777b89b59cc971013b02636d160486f878451fa47d403785a3149701c5fa0034b224772f3a3c685656379f56f8b94cf51101ac91dd3f3c6f00c30bb7bb07b61e7c8d0c504817aa3e336f21a434bfc5e3d3ba54f73aa7b3ea5d3211fc3750806a7b76eb42d42ae34409aa89d1ec5d2294aab4fd93103923dec5f3340c53e04692ed94d61529b73f2e49ecf8a5222eb430a256a242e46ed8d7dd789ceb641e2da4b49ab0a077cd10fdf4068866b57d8ce32e6104621442e812c683b7266c356dd9c17d849ee3f3d396d308b5263410727b605ed3fa19197eb88178093f01b2dbf79daa52da219675f9d1cc0ad992ce6fbfac573e8d7b55a00c8f064dee5785186d688388ac00e5a0e2d73d3b3d5f032edd9c3f50d61050579347ccb351065d84a523ed9325cb77c3c5c32dfc16d6593d80708422b921b38d123259f7a2e991e9553b5b4275621315a98f9ec8407b31e65a7b7952ebb5aa178e0a705662f9e55d5c24106b59e194178ff7ea9cbfa0eb6fd5d74322506da5678d4f55f574254fd47a14ca2970ced6eae61f617b83ea1541e076bb928abe2856f5194bb896218e1384ee56b278e4cccb7e652fb8f0a957671afe571af7337fd3df3d224e9e89ccb7c2dcfa854812af711b30ff11c5edba0ff062011475f1b82843a37f96e47ef6f80f36d9c613ac09c1e55761413c1cf0b77edd936bae11b887ea306a345d450cd80fb0c7d4506823a70d9b8eaa4050ab9729018e919a40d93e953335066fb99f218891fdac1f1093c74111a01655b77f9a9a8716a1ad482b46716fbd14f8e7b0e98c3e2e3acd1ed18fc5b8b9fd1c3a00552c1820eda32ab7f5890cff094cf8d7e38f7901ede9fd2c2287446d862b0a88e7f55a1686a43c8761626feb8294a810be6c760e0ee1ee032811243a0d6389a363fb38e25f955275b7eda6ce20460eda840e3999466a3a93f7d0a96173a66283d810a9b09c0207885113551b35cc2ae3c4c66c7df5a18cb70f6e4f64e352f6e36cac5f9a6aa778bf7990cfdc945a53747322e60a221fee078ad112d22f4f0c083da89756ba63ca0ed1eb56e42930d5505ea09649b6d6d7280ed19935df149f495ae3ff0d7081c0ae5dfce60cbab24</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">这里需要密码才能访问</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
            <tag> 抽象 </tag>
            
            <tag> 形而上 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常用软件备份</title>
      <link href="/posts/d1874913/"/>
      <url>/posts/d1874913/</url>
      
        <content type="html"><![CDATA[<h1 id="Android-常用软件备份"><a href="#Android-常用软件备份" class="headerlink" title="Android 常用软件备份"></a>Android 常用软件备份</h1><p>记录一些自己日常使用的 Android 软件，方便重装或换机时快速找回。</p><h2 id="🎵-音频类"><a href="#🎵-音频类" class="headerlink" title="🎵 音频类"></a>🎵 音频类</h2><p><strong>Salt Player</strong><br>本地音乐播放器，设计简洁，解码表现不错。<br>🔗 <a href="https://moriafly.com/program/salt-player.html">下载链接</a></p><p><strong>音乐标签</strong><br>给音乐文件添加歌词、封面等元数据的工具，适合整理本地曲库。<br>🔗 <a href="https://www.lanzouw.com/i9BTA0oljkvg">下载链接</a></p><p><strong>小宇宙</strong><br>中文播客应用，界面舒服，内容生态也不错。<br>🔗 <a href="https://www.xiaoyuzhoufm.com/download">下载链接</a></p><h2 id="🛠️-工具类"><a href="#🛠️-工具类" class="headerlink" title="🛠️ 工具类"></a>🛠️ 工具类</h2><p><strong>XMind</strong><br>老牌思维导图工具，用来梳理思路、做笔记都很顺手。<br>🔗 <a href="https://xmind.cn/download">下载链接</a></p><p><strong>Termux</strong><br>Android 上的 Linux 终端模拟器，能装各种命令行工具，可玩性极高。<br>🔗 <a href="https://github.com/termux/termux-app/releases">下载链接</a></p><p><strong>Seal</strong><br>开源的视频下载工具，支持 YouTube、B站等多个平台。<br>🔗 <a href="https://github.com/JunkFood02/Seal/releases">下载链接</a></p><p><strong>PicHoro</strong><br>手机端图床管理工具，兼容多种图床服务，方便上传和管理图片。<br>🔗 <a href="https://github.com/Kuingsmile/PicHoro/releases">下载链接</a></p>]]></content>
      
      
      <categories>
          
          <category> 随笔 </category>
          
          <category> 网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随笔 </tag>
            
            <tag> 分享 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Cloudflare上部署邮件服务</title>
      <link href="/posts/ec03d83/"/>
      <url>/posts/ec03d83/</url>
      
        <content type="html"><![CDATA[<h1 id="在-Cloudflare-上部署邮件服务"><a href="#在-Cloudflare-上部署邮件服务" class="headerlink" title="在 Cloudflare 上部署邮件服务"></a>在 Cloudflare 上部署邮件服务</h1><blockquote><p>本文介绍如何使用 Cloudflare Worker 及相关服务搭建自己的邮件服务。</p></blockquote><h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><ol><li>使用 Cloudflare Worker 部署</li><li>Cloudflare 账户上需要有域名</li><li>本教程使用图形化部署，若需要使用 Github Action 部署，请查看官方文档：<a href="https://doc.skymail.ink/">https://doc.skymail.ink/</a></li></ol><hr><h2 id="1-创建项目"><a href="#1-创建项目" class="headerlink" title="1. 创建项目"></a>1. 创建项目</h2><h3 id="1-1-获取源代码"><a href="#1-1-获取源代码" class="headerlink" title="1.1 获取源代码"></a>1.1 获取源代码</h3><p>前往 Github，给项目作者点个 Star 并 fork：<br><a href="https://github.com/maillab/cloud-mail">https://github.com/maillab/cloud-mail</a></p><h3 id="1-2-创建-Worker-项目"><a href="#1-2-创建-Worker-项目" class="headerlink" title="1.2 创建 Worker 项目"></a>1.2 创建 Worker 项目</h3><p>在 Cloudflare Workers 页面，创建新项目，选择“从 Github 导入”方式。<br><img src="/images/cloud-mail/1.2.png" alt="1.2配图"></p><h3 id="1-3-配置路径"><a href="#1-3-配置路径" class="headerlink" title="1.3 配置路径"></a>1.3 配置路径</h3><p>在部署前的配置页面，向下滚动到“路径”设置，将其修改为：<br><code>/mail-worker</code><br><img src="/images/cloud-mail/1.3.png" alt="1.3配图"></p><h3 id="1-4-设置环境变量（必须变量示例）"><a href="#1-4-设置环境变量（必须变量示例）" class="headerlink" title="1.4 设置环境变量（必须变量示例）"></a>1.4 设置环境变量（必须变量示例）</h3><table><thead><tr><th>变量名</th><th>用途说明</th></tr></thead><tbody><tr><td><code>domain</code></td><td>邮箱要使用的域名，多域名请用 JSON 数组格式，例如 <code>[&quot;example.com&quot;,&quot;example2.com&quot;]</code></td></tr><tr><td><code>admin</code></td><td>后台面板的管理员邮箱地址，例如 <code>admin@example.com</code></td></tr><tr><td><code>jwt_secret</code></td><td>JWT 密钥，可以输入一串随机字符串或 UUID，避免使用特殊字符</td></tr></tbody></table><hr><h2 id="2-绑定数据库"><a href="#2-绑定数据库" class="headerlink" title="2. 绑定数据库"></a>2. 绑定数据库</h2><h3 id="2-1-创建数据库"><a href="#2-1-创建数据库" class="headerlink" title="2.1 创建数据库"></a>2.1 创建数据库</h3><p>在 Cloudflare 控制台中分别创建一个 <strong>KV 命名空间</strong> 和一个 <strong>D1 数据库</strong>。<br><img src="/images/cloud-mail/2.1.png" alt="2.1配图"></p><h3 id="2-2-添加绑定"><a href="#2-2-添加绑定" class="headerlink" title="2.2 添加绑定"></a>2.2 添加绑定</h3><p>在 Worker 的“设置” -&gt; “变量”中，添加以下绑定：  </p><ul><li>变量名：<code>kv</code>，绑定到你创建的 KV 命名空间  </li><li>变量名：<code>db</code>，绑定到你创建的 D1 数据库</li></ul><blockquote><p><strong>注意</strong>：变量名必须为 <code>kv</code> 和 <code>db</code>。</p></blockquote><hr><h2 id="3-设置邮件转发"><a href="#3-设置邮件转发" class="headerlink" title="3. 设置邮件转发"></a>3. 设置邮件转发</h2><ol><li>进入你要使用的域名管理页面。</li><li>选择 <strong>电子邮件</strong> → <strong>电子邮件路由</strong> → <strong>路由规则</strong>。</li><li>修改并启用 <strong>Catch-All</strong> 规则，目标选择你刚部署的 Worker 项目。</li></ol><hr><h2 id="4-登录网站"><a href="#4-登录网站" class="headerlink" title="4. 登录网站"></a>4. 登录网站</h2><h3 id="4-1-初始化数据库"><a href="#4-1-初始化数据库" class="headerlink" title="4.1 初始化数据库"></a>4.1 初始化数据库</h3><p>在浏览器中访问以下 URL（请替换实际参数）：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://你的worker自定义域/api/init/你的jwt_secret</span><br></pre></td></tr></table></figure><h3 id="4-2-注册管理员账号"><a href="#4-2-注册管理员账号" class="headerlink" title="4.2 注册管理员账号"></a>4.2 注册管理员账号</h3><ol><li>访问你的 Worker 自定义域名。</li><li>注册管理员账号并登录。</li></ol><hr><h2 id="5-更新部署"><a href="#5-更新部署" class="headerlink" title="5. 更新部署"></a>5. 更新部署</h2><h3 id="5-1-代码同步"><a href="#5-1-代码同步" class="headerlink" title="5.1 代码同步"></a>5.1 代码同步</h3><p>当你从 Github 同步代码后，Worker 会自动更新。</p><h3 id="5-2-重新绑定数据库"><a href="#5-2-重新绑定数据库" class="headerlink" title="5.2 重新绑定数据库"></a>5.2 重新绑定数据库</h3><p>更新后，原先绑定的数据库可能会丢失，需要重新绑定 <code>db</code> 和 <code>kv</code>。</p><h3 id="5-3-更新数据库"><a href="#5-3-更新数据库" class="headerlink" title="5.3 更新数据库"></a>5.3 更新数据库</h3><p>访问以下 URL 更新数据库（不会覆盖已有数据）：  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://你的worker自定义域/api/init/你的jwt_secret</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术分享 </category>
          
          <category> Cloudflare </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cloudflare </tag>
            
            <tag> Mail </tag>
            
            <tag> 开源项目 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
